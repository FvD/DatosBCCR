descriptores <- raw$CompactData$DataSet$Series
for(i in 1:length(series)){
if(i == 1) {
datos <- series[[i]]
print(head(datos))
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
print(head(datos))
}
else {
datos <- cbind(datos, series[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
return(datos)
}
datos <- Descargar.Datos("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
Descargar.Datos <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
for(i in 1:length(lista.pars)){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
raw <- jsonlite::fromJSON(base)
data <- data.frame()
series <- raw$CompactData$DataSet$Series$Obs
descriptores <- raw$CompactData$DataSet$Series
return(raw)
for(i in 1:length(series)){
if(i == 1) {
datos <- series[[i]]
print(head(datos))
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
print(head(datos))
}
else {
datos <- cbind(datos, series[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
return(datos)
}
datos <- Descargar.Datos("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
raw$CompactData$DataSet$Series
datos$CompactData$DataSet$Series
View(datos$CompactData$DataSet$Series)
View(datos$CompactData$DataSet$Series[-length(datos$CompactData$DataSet$Series)])
Descargar.Datos <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
for(i in 1:length(lista.pars)){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
raw <- jsonlite::fromJSON(base)
data <- data.frame()
series <- raw$CompactData$DataSet$Series
descriptores <- series[-length(series)]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]]
print(head(datos))
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
print(head(datos))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
return(datos)
}
datos <- Descargar.Datos("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
View(datos)
Descargar.Datos <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
raw <- jsonlite::fromJSON(base)
data <- data.frame()
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]]
print(head(datos))
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
print(head(datos))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
return(datos)
}
datos <- Descargar.Datos("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
DescargarDatosFMI <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
raw <- jsonlite::fromJSON(base)
data <- data.frame()
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]]
print(head(datos))
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
return(datos)
}
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
DescargarDatosFMI <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
raw <- jsonlite::fromJSON(base)
data <- data.frame()
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]]
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
return(datos)
}
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
datos
InfoBD <- function(id.BD){
datos <- list()
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/DataStructure/"
url <- paste0(base, id.BD)
json <- jsonlite::fromJSON(url)
dim <- json$Structure$KeyFamilies$KeyFamily$Components$Dimension$"@codelist"
datos[["dimensiones_BD"]] <- data.frame(dimension =
paste0("dimensión_ ", 1:NROW(dim)), id = dim)
códigos <- json$Structure$CodeLists$CodeList$Code
lista.códigos <- json$Structure$CodeLists$CodeList$Name$"#text"
for(i in 1:NROW(lista.códigos)){
datos[[lista.códigos[i]]] =
data.frame(indicador = códigos[[i]]$"@value",
descripción = códigos[[i]]$Description$"#text")
}
return(datos)
}
DescargarDatosFMI <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
print(base)
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
raw <- jsonlite::fromJSON(base)
data <- data.frame()
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]]
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
return(datos)
}
plot(datos,Fecha~.)
datos
help(plot)
plot(Fecha ~ ., data = datos)
plot(Fecha~M.US.TXG_FOB_USD.C, datos = data)
plot(Fecha~M.US.TXG_FOB_USD.C, data = datos)
plot(Fecha~M.US.TXG_FOB_USD.CR, data = datos)
plot(Fecha, M.US.TXG_FOB_USD.CR, data = datos)
plot(datos$Fecha, datos$M.US.TXG_FOB_USD.CR)
datos$M.US.TXG_FOB_USD.CR
datos[,1] <- as.Dates(datos[,1], "Y-M")
datos[,1] <- as.Date(datos[,1], "Y-M")
datos
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
datos[,-1] <- as.numeric(datos[,-1])
datos
class(datos)
datos[,-1] <- as.numeric(datos[,-1])
datos[, -1] <- apply(2,as.numeric(datos[,-1])
help(apply)
datos[, -1] <- apply(datos[,-1], 2, as.numeric())
datos[, -1] <- apply(datos[,-1], 2, as.numeric
)
datos
str(datos)
DescargarDatosFMI <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
message(paste("Extrayendo datos del URL:", base))
raw <- jsonlite::fromJSON(base)
data <- data.frame()
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]]
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
datos[, -1] <- apply(datos[,-1], 2, as.numeric)
return(datos)
}
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
datos
plot(Fecha ~ ., data = datos)
plot(datos$M.US.TXG_FOB_USD.CR)
plot(datos$Fecha, datos$M.US.TXG_FOB_USD.CR)
datos[,1] <- as.Date(datos[,1], "%Y-%m")
datos
help("as.Date")
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
datos[,1] <- as.Date(datos[,1], format = "%Y-%m")
datos
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
datos[,1] <- as.Date(datos[,1], format = "%Y-%m")
datos
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
datos[, 1] <-paste(datos[,1],"15","-")
datos
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
datos[, 1] <-paste0(datos[,1],"-15")
datos[, 1] <-as.Date(datos[,1], format = "%Y-%m-%d")
datos
plot(Fecha~M.US.TXG_FOB_USD.CR, data = datos)
plot(Fecha~., data = datos)
plot(.~Fecha, data = datos, type = "l")
plot(~Fecha, data = datos, type = "l")
plot(Fecha,M.US.TXG_FOB_USD.CR, data = datos)
plot(datos$Fecha, datos$M.US.TXG_FOB_USD.CR)
plot(datos$Fecha, datos$M.US.TXG_FOB_USD.CR, type = "ñ")
plot(datos$Fecha, datos$M.US.TXG_FOB_USD.CR, type = "l")
DescargarDatosFMI <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
message(paste("Extrayendo datos del URL:", base))
raw <- jsonlite::fromJSON(base)
data <- data.frame()
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]]
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
datos[, -1] <- apply(datos[,-1], 2, as.numeric)
return(datos)
}
paste0(id.BD,"/")
DescargarDatosFMI <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
message(paste("Extrayendo datos del URL:", base))
raw <- jsonlite::fromJSON(base)
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]]
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
datos[, -1] <- apply(datos[,-1], 2, as.numeric)
return(datos)
}
library(reshape2)
datos <- melt(datos, id.vars = "Fecha")
datos
library(ggplot2)
ggplot2(datos, aes( x = Fecha, y = Value)) + geom_line() + facet_wrap(.~variable)
ggplot(datos, aes( x = Fecha, y = Value)) + geom_line() + facet_wrap(.~variable)
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_wrap(.~variable)
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_grid(.~variable)
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_grid(.~variable)+scale_y_continues(scale = "free.y")
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_grid(.~variable)+scale_y_continue(scale = "free.y")
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_grid(.~variable)+ scale(scale_y = "free")
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_grid(.~variable, scales ="free_y")
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_grid(.~variable, scales ="free_y", ncol = 2)
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_wrap(~variable, scales ="free_y", ncol = 2)
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("CR"),"TXG_FOB_USD",c("W00","MX", "US", "CN"))
datos
source('~/Packages/DatosBCCR/R/IMF.R', echo=TRUE)
InfoBD("DOT")
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("CR"),"TXG_FOB_USD",c("W00","MX", "US", "CN"))
datos
DescargarDatosFMI <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
message(paste("Extrayendo datos del URL:", base))
raw <- jsonlite::fromJSON(base)
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]]
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
print(datos)
datos[, -1] <- apply(datos[,-1], 2, as.numeric)
return(datos)
}
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("CR"),"TXG_FOB_USD",c("W00","MX", "US", "CN"))
InfoBD("DOT")
DescargarDatosFMI <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
message(paste("Extrayendo datos del URL:", base))
raw <- jsonlite::fromJSON(base)
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]][,1:2]
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
print(datos)
datos[, -1] <- apply(datos[,-1], 2, as.numeric)
return(datos)
}
datos
datos <- DescargarDatosFMI("DOT", 2000, 2015, "M",c("CR"),"TXG_FOB_USD",c("W00","MX", "US", "CN"))
datos <- DescargarDatosFMI("DOT", 2000, 2015, "Y",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
InfoBD("DOT")
datos <- DescargarDatosFMI("DOT", 2000, 2015, "A",c("US","JP"),"TXG_FOB_USD",c("W00","CR"))
source('~/Packages/DatosBCCR/R/IMF.R', echo=TRUE)
str(datos)
datos[,1] = as.numeric(datos[,1])
datos <- melt(datos, id.vars = "Fecha")
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_wrap(~variable, scales ="free_y", ncol = 2)
datos <- DescargarDatosFMI("DOT", 2000, 2015, "A",c("CR"),"TXG_FOB_USD",c("W00","MX", "US", "CN"))
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_wrap(~variable, scales ="free_y", ncol = 2)
datos[,1] = as.numeric(datos[,1])
datos <- melt(datos, id.vars = "Fecha")
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_wrap(~variable, scales ="free_y", ncol = 2)
datos <- DescargarDatosFMI("DOT", 2000, 2016, "M",c("CR"),"TXG_FOB_USD",c("W00","MX", "US", "CN"))
datos <- melt(datos, id.vars = "Fecha")
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_wrap(~variable, scales ="free_y", ncol = 2)
datos
datos[,1] = as.factor(datos[,1])
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_wrap(~variable, scales ="free_y", ncol = 2)
datos
datos <- DescargarDatosFMI("DOT", 2000, 2016, "M",c("CR"),"TXG_FOB_USD",c("W00","MX", "US", "CN"))
datos[, 1] <- paste0(datos[,1], "-15")
datos[, 1] <- as.Date(datos[, 1], format = "%Y-%m-%d")
datos <- melt(datos, id.vars = "Fecha")
ggplot(datos, aes( x = Fecha, y = value)) + geom_line() + facet_wrap(~variable, scales ="free_y", ncol = 2)
datos <- DescargarDatosFMI("DOT", 2000, 2016, "M",c("CR"),"TXG_FOB_USD",c("W00","MX", "US", "CN"))
datos
InfoBD("DOT")
datos <- DescargarDatosFMI("DOT", 2000, 2016, "M",c("CR"),"TXG_FOB_USD","NL")
datos <- DescargarDatosFMI("DOT", 2000, 2016, "M",c("CR"),"TXG_FOB_USD",c("W00","MX", "US", "NL"))
datos
datos <- DescargarDatosFMI("DOT", 2000, 2016, "M",c("CR"),"TXG_FOB_USD", "NL")
DescargarDatosFMI <- function(id.BD, inicio, fin, ...){
lista.pars <- list(...)
base <- "http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/" %>%
paste0(id.BD,"/")
n <- length(lista.pars)
for(i in 1:n){
base <- paste0(base, paste0(lista.pars[[i]], collapse ="+"), ".")
}
base <- paste0(base, "?startPeriod=", inicio, "&endPeriod=", fin)
message(paste("Extrayendo datos del URL:", base))
raw <- jsonlite::fromJSON(base)
series <- raw$CompactData$DataSet$Series
descriptores <- series[1:n]
for(i in 1:length(series$Obs)){
if(i == 1) {
datos <- series$Obs[[i]][,1:2]
colnames(datos) <- c("Fecha", paste0(descriptores[i, ],
collapse = "."))
print(datos)
}
else {
datos <- cbind(datos, series$Obs[[i]][,2])
colnames(datos)[i + 1] <- c(paste0(descriptores[i, ],
collapse = "."))
}
}
datos[, -1] <- apply(datos[,-1], 2, as.numeric)
return(datos)
}
datos <- DescargarDatosFMI("DOT", 2000, 2016, "M",c("CR"),"TXG_FOB_USD", "NL")
datos <- DescargarDatosFMI("DOT", 2000, 2016, "M",c("CR"),"TXG_FOB_USD", c("NL"))
URL ="http://dataservices.imf.org/REST/SDMX_JSON.svc/CompactData/DOT/M.CR.TXG_FOB_USD.NL.?startPeriod=2000&endPeriod=2016"
x <- fromJSON("url")
x <- fromJSON(url)
x$$CompactData$DataSet$Series
x$CompactData$DataSet$Series
x
x$CompactData$DataSet
names(x)
names(x$Structure)
url
x <- fromJSON(URL)
